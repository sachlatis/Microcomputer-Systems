START:
	IN 10H ; ’ρση της προστασίας μνήμης
	MVI A,0DH ; Αρχικοποίηση διακοπής 6.5
	SIM
	MVI A,FFH ; Σβήσιμο των leds εξόδου
	STA 3000H
	MVI A,00H ; Αρχικοποίηση σημαίας διακοπής, την οποία
	STA 0900H ; διατηρούμε στην ελεύθερη θέση μνήμης 0900H
	LXI H,0BF0H ; Αρχικοποίηση του τμήματος μνήμης που
	MVI A,10H ; χρησιμοποιείται από τη ρουτίνα DCD με τιμές
	MOV M,A ; τις οποίες απεικονίζει σε σβηστά 7 segment
	INX H ; displays
	MOV M,A
	INX H
	MOV M,A
	INX H
	MOV M,A
	INX H
	MOV M,A
	INX H
	MOV M,A
	EI ; Ενεργοποίηση των διακοπών

WAIT: 		   ; Αναμονή για διακοπή
	LDA 0900H ; Ελέγχουμε αν έχει γίνει 1 η σημαία, που
	CPI 00H ; σημαίνει ότι έγινε διακοπή
	JZ WAIT
	MVI A,00H ; ’ναμμα των leds και αλλαγή της σημαίας της
	STA 3000H ; διακοπής
	STA 0900H
	MVI E,3CH ; Ο Ε == counter για τις 60 επαναλήψεις

MINUTE_LOOP:
	MOV A,E ; Το τμήμα αυτό του προγράμματος μετατρέπει τον
	MVI D,FFH ; counter της επανάληψης (E), ο οποίος είναι

CALC_SEC: ; δυαδικός αριθμός (μεταξύ 0 και 60), σε
	INR D ; σε δεκαδικό. Τα δύο ψηφία του αποθηκεύονται
	SUI 0AH ; στις θέσεις μνήμης 0BF0H και 0ΒF1Η,
	JNC CALC_SEC ; απεικονίζονται στα δύο δεξιότερα 7 segment
	ADI 0AH ; displays
	STA 0BF0H
	MOV A,D
	STA 0BF1H

OUT: 
	CALL DCD
	MVI A,FFH
	LXI B,0860H 
	STA 3000H
	CALL DELB
	CMA
	STA 3000H
	CALL DELB
	CMA 
	STA 3000H
	CALL DELB
	CMA
	STA 3000H
	CALL DELB
	CMA
	STA 3000H ; Mε αυτόν τον τρόπο πετυχαίνουμε να έχουμε περίοδο 1/2sec
	CALL DELB ; στον pc που τρεξαμε τις προσομοιώσεις
	LDA 0900H ; Έλεγχος για το αν ξαναέγινε διακοπή
	CPI 00H
	JZ REFRESH_END_IF ; Αν έγινε, τότε επαναφέρω τον counter της
	MVI E,3DH ; επανάληψής μου στην αρχική του τιμή και
	MVI A,00H ; μηδενίζω τη σημαία διακοπής.
	STA 0900H ; Παρατήρηση: επαναφέρουμε τον counter (Ε) στην
		   ; τιμή 61, διότι αμέσως μετά ακολουθεί εντολή DCR,
		   ; ενώ εμείς θέλουμε η νέα εκτέλεση της επανάληψης
                 ; να ξεκινήσει με τον counter στο 60

REFRESH_END_IF:
	DCR E
	JNZ MINUTE_LOOP	
	LXI H,0BF0H ; Απεικόνιση στα 7 segment displays του αριθμού 00
	MVI M,00H
	MVI M,00H
	CALL DCD
	MVI A,FFH ; Σβήσιμο των leds
	STA 3000H
	JMP WAIT

INTR_ROUTINE: ; Η ρουτίνα εξυπηρέτησης της διακοπής το μόνο που κάνει
		; είναι να "σηκώνει" τη σημαία που μας δείχνει
		; ότι έχει γίνει διακοπή, την οποία έχουμε
		; αποθηκευμένη στη θέση μνήμης 0900H

	PUSH PSW ; Αποθήκευση της κατάστασης του μΕ, αφού πρόκειται
		  ; να αλλάξουμε τα περιεχόμενα του καταχωρητή A

	MVI A,01H
	STA 0900H ; "Σήκωμα" του flag
	POP PSW
	EI ; Επανενεργοποίηση των διακοπών
	RET
END